!function(o,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/common/http"),require("ng2-cookies"),require("@angular/common")):"function"==typeof define&&define.amd?define("ngx-loggly-logger",["exports","@angular/core","@angular/common/http","ng2-cookies","@angular/common"],t):t(o["ngx-loggly-logger"]={},o.ng.core,o.ng.common.http,o.Cookie,o.ng.common)}(this,function(o,t,e,n,i){"use strict";var s=function(){function o(o){this._http=o,this.LOGGLY_INPUT_PREFIX="http"+("https:"===document.location.protocol?"s":"")+"://",this.LOGGLY_COLLECTOR_DOMAIN="logs-01.loggly.com",this.LOGGLY_SESSION_KEY="logglytrackingsession",this.LOGGLY_SESSION_KEY_LENGTH=this.LOGGLY_SESSION_KEY+1,this.LOGGLY_PROXY_DOMAIN="loggly"}return o.prototype.uuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(o){var t=16*Math.random()|0;return("x"===o?t:3&t|8).toString(16)})},o.prototype.setKey=function(o,t){o.key=t,o.setSession(),this.setInputUrl(o)},o.prototype.setTag=function(o,t){o.tag=t},o.prototype.setDomainProxy=function(o,t){o.useDomainProxy=t,this.setInputUrl(o)},o.prototype.setSendConsoleError=function(i,o){if(i.sendConsoleErrors=o,!0===i.sendConsoleErrors){var s=window.onerror;window.onerror=function(o,t,e,n){i.push({category:"BrowserJsException",exception:{message:o,url:t,lineno:e,colno:n}}),s&&"function"==typeof s&&s.apply(window,arguments)}}},o.prototype.setInputUrl=function(o){!0===o.useDomainProxy?o.inputUrl=this.LOGGLY_INPUT_PREFIX+window.location.host+"/"+this.LOGGLY_PROXY_DOMAIN+"/inputs/"+o.key+"/tag/"+o.tag:o.inputUrl=this.LOGGLY_INPUT_PREFIX+(o.logglyCollectorDomain||this.LOGGLY_COLLECTOR_DOMAIN)+"/inputs/"+o.key+"/tag/"+o.tag},o.prototype.setSession=function(o){o?(this.session_id=o,this.setCookie(this.session_id)):this.session_id||(this.session_id=this.readCookie(),this.session_id||(this.session_id=this.uuid(),this.setCookie(this.session_id)))},o.prototype.push=function(o){var t=typeof o;if(o&&("object"===t||"string"===t)){var e=this;if("string"===t)o={text:o};else{if(o.logglyCollectorDomain)return void(e.logglyCollectorDomain=o.logglyCollectorDomain);if(o.sendConsoleErrors!==undefined&&this.setSendConsoleError(e,o.sendConsoleErrors),o.tag&&this.setTag(e,o.tag),o.useDomainProxy&&this.setDomainProxy(e,o.useDomainProxy),o.logglyKey)return void this.setKey(e,o.logglyKey);if(o.session_id)return void e.setSession(o.session_id)}e.key&&e.track(o).subscribe(function(o){},function(o){console.error(o)})}},o.prototype.track=function(o){return o.sessionId=this.session_id,this._http.post(this.inputUrl,o,{headers:(new e.HttpHeaders).set("Content-Type","text/plain")})},o.prototype.readCookie=function(){var o=n.Cookie.get(this.LOGGLY_SESSION_KEY);if(o){var t=o.indexOf(this.LOGGLY_SESSION_KEY);if(t<0)return!1;var e=o.indexOf(";",t+1);return e=e<0?o.length:e,o.slice(t+this.LOGGLY_SESSION_KEY_LENGTH,e)}return!1},o.prototype.setCookie=function(o){n.Cookie.set(this.LOGGLY_SESSION_KEY,o)},o}();s.decorators=[{type:t.Injectable}],s.ctorParameters=function(){return[{type:e.HttpClient}]};var r=function(){function o(){}return o.forRoot=function(){return{ngModule:o,providers:[s]}},o}();r.decorators=[{type:t.NgModule,args:[{imports:[i.CommonModule,e.HttpClientModule],declarations:[],exports:[]}]}],o.NgxLogglyModule=r,o.LogglyService=s,Object.defineProperty(o,"__esModule",{value:!0})});
//# sourceMappingURL=ngx-loggly-logger.umd.min.js.map
